#ifndef WHYTE_H
#define WHYTE_H

#include <string>
#include <vector>

/* apt sudo install libgsl-dev
   LDFLAGS of GSL: -lgsl -lgslcblas -lm
   g++ -Wall -O2 -march=native main.cpp whyte.cpp -o main -lgsl -lgslcblas -lm -lboost_filesystem */

class WHyTe
{
public:
    WHyTe();
    ~WHyTe();
    
    void readFromXML(const std::string &fileName);

    double getLikelihood(double time, double x, double y, double heading, double speed);

private:
    long no_clusters;
    long no_periods;

    std::vector<double> periodicities;
    
    std::vector<double> W;
    
    std::vector<std::vector<double>> C;

    std::vector<std::vector<std::vector<double>>> PREC;

    /*
    long no_clusters = 2;
    long no_periods = 2;

    std::vector<double> periodicities = {86400.0, 604800.0};
    
    std::vector<double> W = {5.000458861017754719e-01, 4.999541138982235844e-01};
    
    std::vector<std::vector<double>> C = {
        {-2.062618981651223482e+00, 6.519035358124850354e+00, -6.165755283389109248e-02, -2.410804823006326703e-02, -6.434752377068369000e-01, 4.807917021522246648e-01, 5.454373898044986291e-01, -3.014563682897191677e-01},
        {-2.062481842580648372e+00, 6.511367782853551667e+00, -6.566212535341733880e-02, -2.526266066186622083e-02, -6.424632200547406580e-01, 4.885322980195815901e-01, 5.502328616640215220e-01, -3.019955831525245049e-01}
    };
    
    std::vector<std::vector<std::vector<double>>> PREC = {
        {
            {1.568970918722547570e-01, 3.225170354471625783e-02, -3.609889048532083367e-02, -7.800837253309099092e-03, 8.694299714150670322e-02, 1.539798895834372794e-01, -5.223955225650293160e-02, 1.963797533324864938e-02},
            {3.225170354471625783e-02, 1.111048331699018565e-01, -6.666588154605457284e-02, -9.795739787090215756e-02, -2.609136775613155046e-01, 1.244026110921464257e-01, -8.055430358629915577e-02, 3.149456307391732685e-02},
            {-3.609889048532083367e-02, -6.666588154605457284e-02, 5.783439445800104828e+00, -1.054666602243655854e-01, 1.554045241734340610e-01, 6.250854312672492474e-01, -1.988017585654763830e-01, 5.632710603860449083e-01},
            {-7.800837253309099092e-03, -9.795739787090215756e-02, -1.054666602243655854e-01, 5.449897374406267758e+00, 7.928183622885278670e-01, -4.778489362799664408e-01, 2.053381626802063542e-01, 6.042330467031533509e-02},
            {8.694299714150670322e-02, -2.609136775613155046e-01, 1.554045241734340610e-01, 7.928183622885278670e-01, 1.355263353773987944e+01, -2.597631335384007034e+00, 1.194308440616891204e-01, 2.691231852963963389e-01},
            {1.539798895834372794e-01, 1.244026110921464257e-01, 6.250854312672492474e-01, -4.778489362799664408e-01, -2.597631335384007034e+00, 4.978098857072437156e+00, -7.941944909583847911e-01, 1.675728650642841711e+00},
            {-5.223955225650293160e-02, -8.055430358629915577e-02, -1.988017585654763830e-01, 2.053381626802063542e-01, 1.194308440616891204e-01, -7.941944909583847911e-01, 3.074748304442503688e+00, -1.955971251627599550e+00},
            {1.963797533324864938e-02, 3.149456307391732685e-02, 5.632710603860449083e-01, 6.042330467031533509e-02, 2.691231852963963389e-01, 1.675728650642841711e+00, -1.955971251627599550e+00, 6.638955151299498425e+00}
        },
        {
            {1.563408037584682053e-01, 3.197385418996661482e-02, -3.575315383095323263e-02, -7.551202079491961539e-03, 8.092135982761655688e-02, 1.516292876821849767e-01, -5.110904337982464379e-02, 1.759078694739373006e-02},
            {3.197385418996661482e-02, 1.113595897642098292e-01, -7.105063119274250549e-02, -9.847792374511937785e-02, -2.636807959514995692e-01, 1.262230079498225799e-01, -8.159524192317153812e-02, 3.238124354433339486e-02},
            {-3.575315383095323263e-02, -7.105063119274250549e-02, 5.526729806272150824e+00, -1.222505009394436459e-01, 2.156761466500163038e-01, 6.105330356889322463e-01, -1.884911207184100379e-01, 5.802846235482415072e-01},
            {-7.551202079491961539e-03, -9.847792374511937785e-02, -1.222505009394436459e-01, 5.358841376888661578e+00, 7.907211344663929165e-01, -4.747298330163349234e-01, 1.950234583872337835e-01, 7.674201300189449626e-02},
            {8.092135982761655688e-02, -2.636807959514995692e-01, 2.156761466500163038e-01, 7.907211344663929165e-01, 1.363388528874378736e+01, -2.819378016490062144e+00, 1.078743937142722376e-01, 2.569002649709901109e-01},
            {1.516292876821849767e-01, 1.262230079498225799e-01, 6.105330356889322463e-01, -4.747298330163349234e-01, -2.819378016490062144e+00, 5.156619530714542599e+00, -7.808067625867092243e-01, 1.675728071254485974e+00},
            {-5.110904337982464379e-02, -8.159524192317153812e-02, -1.884911207184100379e-01, 1.950234583872337835e-01, 1.078743937142722376e-01, -7.808067625867092243e-01, 3.113303798643002551e+00, -1.990443706597358364e+00},
            {1.759078694739373006e-02, 3.238124354433339486e-02, 5.802846235482415072e-01, 7.674201300189449626e-02, 2.569002649709901109e-01, 1.675728071254485974e+00, -1.990443706597358364e+00, 6.700406630328284763e+00}
        }
    };
    */
};

#endif
